Anvil + IPC Keystore Integration
=================================

File Structure:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

scripts/
â”œâ”€â”€ setup-anvil-with-ipc-keys.sh     â­ Main setup script
â”‚   â”œâ”€â”€ Starts Anvil with deterministic config
â”‚   â”œâ”€â”€ Reads ~/.ipc/evm_keystore.json
â”‚   â”œâ”€â”€ Funds all accounts with 10,000 ETH
â”‚   â””â”€â”€ Creates stop script and saves PID
â”‚
â”œâ”€â”€ anvil-persistent-state.sh         ğŸ’¾ State management
â”‚   â”œâ”€â”€ save  - Save current blockchain state
â”‚   â”œâ”€â”€ load  - Restore saved state
â”‚   â”œâ”€â”€ info  - Show state information
â”‚   â””â”€â”€ list  - Generate account list
â”‚
â”œâ”€â”€ quick-anvil.sh                    ğŸš€ Quick launcher
â”‚   â”œâ”€â”€ Checks dependencies
â”‚   â”œâ”€â”€ Validates keystore
â”‚   â””â”€â”€ Launches main setup script
â”‚
â”œâ”€â”€ aliases.sh                        ğŸ”§ Convenience aliases
â”‚   â”œâ”€â”€ anvil-start, anvil-stop
â”‚   â”œâ”€â”€ anvil-save, anvil-load
â”‚   â”œâ”€â”€ Helper functions
â”‚   â””â”€â”€ Source with: source scripts/aliases.sh
â”‚
â”œâ”€â”€ ANVIL_IPC_SETUP.md               ğŸ“– Complete guide
â”‚   â”œâ”€â”€ Quick start
â”‚   â”œâ”€â”€ Configuration
â”‚   â”œâ”€â”€ Workflows
â”‚   â”œâ”€â”€ Troubleshooting
â”‚   â””â”€â”€ Advanced usage
â”‚
â”œâ”€â”€ QUICK_REFERENCE.md               ğŸ¯ Cheat sheet
â”‚   â”œâ”€â”€ Common commands
â”‚   â”œâ”€â”€ Network details
â”‚   â”œâ”€â”€ Quick fixes
â”‚   â””â”€â”€ File locations
â”‚
â”œâ”€â”€ IMPLEMENTATION_SUMMARY.md        ğŸ“‹ Technical docs
â”‚   â”œâ”€â”€ Architecture
â”‚   â”œâ”€â”€ How it works
â”‚   â”œâ”€â”€ Testing
â”‚   â””â”€â”€ Security notes
â”‚
â””â”€â”€ .anvil-ipc-structure.txt         ğŸ“Š This file


Data Flow:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  User runs       â”‚
   â”‚  setup script    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Read IPC         â”‚â”€â”€â”€â”€â”€â”€â–º ~/.ipc/evm_keystore.json
   â”‚ Keystore         â”‚        [
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          {"address": "0x...", "private_key": "..."},
            â”‚                    {"address": "0x...", "private_key": "..."}
            â”‚                  ]
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Start Anvil      â”‚â”€â”€â”€â”€â”€â”€â–º Port: 8545
   â”‚ (if needed)      â”‚        Chain ID: 31337
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        Mnemonic: test test test...
            â”‚
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Fund Accounts    â”‚â”€â”€â”€â”€â”€â”€â–º eth_sendTransaction
   â”‚ (10,000 ETH)     â”‚        from: 0xf39Fd... (funder)
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        to: <IPC keystore addresses>
            â”‚
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Show Summary     â”‚â”€â”€â”€â”€â”€â”€â–º âœ… 16 accounts funded
   â”‚                  â”‚        ğŸ“Š Balances: 10,000 ETH each
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        ğŸŒ RPC: http://localhost:8545
            â”‚
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Create           â”‚â”€â”€â”€â”€â”€â”€â–º /tmp/stop-anvil-ipc.sh
   â”‚ Management       â”‚        /tmp/anvil_ipc.pid
   â”‚ Scripts          â”‚        /tmp/anvil_ipc_keys.log
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


Key Features:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âœ… Deterministic Setup      - Same keys every restart
âœ… Automatic Funding        - All keystore accounts funded
âœ… State Persistence        - Save/restore blockchain state
âœ… Idempotent              - Safe to run multiple times
âœ… Interactive Menu        - User-friendly prompts
âœ… Error Handling          - Clear error messages
âœ… Comprehensive Docs      - Multiple documentation files
âœ… Convenience Tools       - Aliases and helper scripts


Quick Start Commands:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# Start everything
./scripts/setup-anvil-with-ipc-keys.sh

# Stop Anvil
/tmp/stop-anvil-ipc.sh

# Save state
./scripts/anvil-persistent-state.sh save

# Load state
./scripts/anvil-persistent-state.sh load

# Use aliases
source scripts/aliases.sh
anvil-start


Network Configuration:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

RPC URL:      http://localhost:8545
Chain ID:     31337
Block Time:   1 second
Gas Limit:    30,000,000
Accounts:     All from ~/.ipc/evm_keystore.json
Funding:      10,000 ETH per account


Files Created by Scripts:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Runtime:
  /tmp/anvil_ipc_keys.log      - Anvil output logs
  /tmp/anvil_ipc.pid           - Process ID
  /tmp/stop-anvil-ipc.sh       - Stop script

State:
  ~/.ipc/anvil-state/          - State directory
  ~/.ipc/anvil-state/state.json - Saved blockchain state
  ~/.ipc/anvil-state/metadata.json - State metadata


Workflow Example:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Day 1:
  $ ./scripts/setup-anvil-with-ipc-keys.sh
  âœ… Anvil started
  âœ… 16 accounts funded with 10,000 ETH

  $ # Deploy contracts, run tests

  $ ./scripts/anvil-persistent-state.sh save
  ğŸ’¾ State saved

  $ /tmp/stop-anvil-ipc.sh
  ğŸ›‘ Anvil stopped

Day 2:
  $ ./scripts/setup-anvil-with-ipc-keys.sh
  âœ… Anvil started

  $ ./scripts/anvil-persistent-state.sh load
  âœ… State restored

  $ # Continue development with same state


Customization:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Edit scripts/setup-anvil-with-ipc-keys.sh:

  ANVIL_PORT=8545              # Change port
  ANVIL_CHAIN_ID=31337         # Change chain ID
  INITIAL_BALANCE="10000"      # Change funding (ETH)
  IPC_KEYSTORE="..."           # Change keystore path


Documentation Files:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“– ANVIL_IPC_SETUP.md         - Complete guide (15 sections)
ğŸ¯ QUICK_REFERENCE.md          - Cheat sheet for daily use
ğŸ“‹ IMPLEMENTATION_SUMMARY.md   - Technical documentation
ğŸ“Š .anvil-ipc-structure.txt    - This overview file


Integration with IPC:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# All IPC CLI commands work with funded accounts
ipc-cli wallet list --keystore-path ~/.ipc
ipc-cli subnet create --parent /r31337 --keystore-path ~/.ipc
ipc-cli subnet join --subnet /r31337/t... --keystore-path ~/.ipc

# Use local Anvil as parent network
--subnet /r31337  # Chain ID 31337 = Anvil


Security Notes:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âš ï¸  FOR LOCAL DEVELOPMENT ONLY
âš ï¸  Never use these keys on mainnet
âš ï¸  Keystore is unencrypted
âš ï¸  Private keys exposed in operations
âš ï¸  Clear keystore between projects


Support & Help:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Documentation:  scripts/ANVIL_IPC_SETUP.md
Quick Ref:      scripts/QUICK_REFERENCE.md
Main README:    README.md
Slack:          #ipc-help (Filecoin Slack)
GitHub:         Open issue in IPC repository


Version: 1.0
Created: October 22, 2025
License: MIT/Apache-2.0

